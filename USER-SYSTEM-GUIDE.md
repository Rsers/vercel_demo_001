# Vercel ç”¨æˆ·ç®¡ç†ç³»ç»Ÿä½¿ç”¨æŒ‡å—

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç”¨æˆ·ç®¡ç†ç³»ç»Ÿï¼Œä½¿ç”¨ Vercel PostgreSQL æ•°æ®åº“æ¥å­˜å‚¨å’Œç®¡ç†ç”¨æˆ·æ•°æ®ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. éƒ¨ç½²åˆ° Vercel

1. å°†ä»£ç æ¨é€åˆ° GitHub ä»“åº“
2. åœ¨ Vercel ä¸­å¯¼å…¥é¡¹ç›®
3. åœ¨ Vercel é¡¹ç›®ä¸­æ·»åŠ  PostgreSQL æ•°æ®åº“

### 2. åˆå§‹åŒ–æ•°æ®åº“

è®¿é—® `/api/init-db` ç«¯ç‚¹æ¥åˆ›å»ºå¿…è¦çš„æ•°æ®åº“è¡¨ï¼š

```bash
curl -X POST https://your-app.vercel.app/api/init-db
```

### 3. åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·

```bash
curl -X POST https://your-app.vercel.app/api/create-admin \
  -H "Content-Type: application/json" \
  -d '{
    "adminKey": "vercel-demo-2024",
    "username": "admin",
    "email": "admin@example.com",
    "password": "admin123456",
    "fullName": "ç³»ç»Ÿç®¡ç†å‘˜"
  }'
```

## ğŸ“š API ç«¯ç‚¹è¯´æ˜

### è®¤è¯ç›¸å…³

#### ç”¨æˆ·æ³¨å†Œ
- **ç«¯ç‚¹**: `POST /api/auth/register`
- **å‚æ•°**:
  ```json
  {
    "username": "ç”¨æˆ·å",
    "email": "é‚®ç®±åœ°å€",
    "password": "å¯†ç ",
    "fullName": "å§“åï¼ˆå¯é€‰ï¼‰"
  }
  ```

#### ç”¨æˆ·ç™»å½•
- **ç«¯ç‚¹**: `POST /api/auth/login`
- **å‚æ•°**:
  ```json
  {
    "username": "ç”¨æˆ·åæˆ–é‚®ç®±",
    "password": "å¯†ç "
  }
  ```

#### è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
- **ç«¯ç‚¹**: `GET /api/auth/me`
- **éœ€è¦**: æœ‰æ•ˆçš„ä¼šè¯ Cookie

#### ç”¨æˆ·ç™»å‡º
- **ç«¯ç‚¹**: `POST /api/auth/logout`
- **éœ€è¦**: æœ‰æ•ˆçš„ä¼šè¯ Cookie

### ç”¨æˆ·ç®¡ç†ï¼ˆç®¡ç†å‘˜åŠŸèƒ½ï¼‰

#### è·å–ç”¨æˆ·åˆ—è¡¨
- **ç«¯ç‚¹**: `GET /api/users?page=1&limit=10`
- **éœ€è¦**: ç®¡ç†å‘˜æƒé™

#### æ›´æ–°ç”¨æˆ·ä¿¡æ¯
- **ç«¯ç‚¹**: `PUT /api/users`
- **éœ€è¦**: ç®¡ç†å‘˜æƒé™
- **å‚æ•°**:
  ```json
  {
    "userId": "ç”¨æˆ·ID",
    "fullName": "æ–°å§“åï¼ˆå¯é€‰ï¼‰",
    "role": "æ–°è§’è‰²ï¼ˆå¯é€‰ï¼‰",
    "avatarUrl": "å¤´åƒURLï¼ˆå¯é€‰ï¼‰"
  }
  ```

#### åˆ é™¤ç”¨æˆ·
- **ç«¯ç‚¹**: `DELETE /api/users`
- **éœ€è¦**: ç®¡ç†å‘˜æƒé™
- **å‚æ•°**:
  ```json
  {
    "userId": "ç”¨æˆ·ID"
  }
  ```

## ğŸ—„ï¸ æ•°æ®åº“ç»“æ„

### users è¡¨
- `id` - ä¸»é”®
- `username` - ç”¨æˆ·åï¼ˆå”¯ä¸€ï¼‰
- `email` - é‚®ç®±ï¼ˆå”¯ä¸€ï¼‰
- `password_hash` - åŠ å¯†åçš„å¯†ç 
- `full_name` - å§“å
- `avatar_url` - å¤´åƒURL
- `role` - è§’è‰²ï¼ˆuser/adminï¼‰
- `created_at` - åˆ›å»ºæ—¶é—´
- `updated_at` - æ›´æ–°æ—¶é—´

### user_sessions è¡¨
- `id` - ä¸»é”®
- `user_id` - ç”¨æˆ·IDï¼ˆå¤–é”®ï¼‰
- `session_token` - ä¼šè¯ä»¤ç‰Œ
- `expires_at` - è¿‡æœŸæ—¶é—´
- `created_at` - åˆ›å»ºæ—¶é—´

### user_activities è¡¨
- `id` - ä¸»é”®
- `user_id` - ç”¨æˆ·IDï¼ˆå¤–é”®ï¼‰
- `activity_type` - æ´»åŠ¨ç±»å‹
- `description` - æ´»åŠ¨æè¿°
- `ip_address` - IPåœ°å€
- `user_agent` - ç”¨æˆ·ä»£ç†
- `created_at` - åˆ›å»ºæ—¶é—´

## ğŸ” å®‰å…¨ç‰¹æ€§

1. **å¯†ç åŠ å¯†**: ä½¿ç”¨ bcryptjs è¿›è¡Œå¯†ç å“ˆå¸Œ
2. **ä¼šè¯ç®¡ç†**: åŸºäºä»¤ç‰Œçš„ä¼šè¯ç®¡ç†
3. **æƒé™æ§åˆ¶**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
4. **è¾“å…¥éªŒè¯**: æœåŠ¡å™¨ç«¯æ•°æ®éªŒè¯
5. **SQL æ³¨å…¥é˜²æŠ¤**: ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢

## ğŸ¨ å‰ç«¯åŠŸèƒ½

### ç”¨æˆ·ç•Œé¢
- ç°ä»£åŒ–çš„å“åº”å¼è®¾è®¡
- ç”¨æˆ·æ³¨å†Œå’Œç™»å½•è¡¨å•
- ä¸ªäººèµ„æ–™å±•ç¤º
- ç”¨æˆ·åˆ—è¡¨ç®¡ç†ï¼ˆç®¡ç†å‘˜ï¼‰
- å®æ—¶çŠ¶æ€æ›´æ–°

### åŠŸèƒ½ç‰¹ç‚¹
- è‡ªåŠ¨ç™»å½•çŠ¶æ€æ£€æŸ¥
- å‹å¥½çš„é”™è¯¯æç¤º
- åˆ†é¡µæ˜¾ç¤ºç”¨æˆ·åˆ—è¡¨
- ç§»åŠ¨ç«¯é€‚é…

## ğŸš€ éƒ¨ç½²æ³¨æ„äº‹é¡¹

1. **ç¯å¢ƒå˜é‡**: ç¡®ä¿ Vercel PostgreSQL è¿æ¥å­—ç¬¦ä¸²æ­£ç¡®é…ç½®
2. **HTTPS**: ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨ HTTPS
3. **Cookie å®‰å…¨**: ä¼šè¯ Cookie è®¾ç½®ä¸º HttpOnly
4. **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

## ğŸ“± ä½¿ç”¨æµç¨‹

1. è®¿é—® `/index-user.html` é¡µé¢
2. é¦–æ¬¡ä½¿ç”¨éœ€è¦åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·
3. ä½¿ç”¨ç®¡ç†å‘˜è´¦æˆ·ç™»å½•
4. å¯ä»¥åˆ›å»ºæ™®é€šç”¨æˆ·æˆ–ç®¡ç†ç°æœ‰ç”¨æˆ·
5. æ‰€æœ‰æ“ä½œéƒ½ä¼šè®°å½•åœ¨ç”¨æˆ·æ´»åŠ¨æ—¥å¿—ä¸­

## ğŸ”§ å¼€å‘è¯´æ˜

### æœ¬åœ°å¼€å‘
```bash
# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

### æŠ€æœ¯æ ˆ
- **åç«¯**: Vercel Serverless Functions
- **æ•°æ®åº“**: Vercel PostgreSQL
- **å‰ç«¯**: åŸç”Ÿ HTML/CSS/JavaScript
- **å®‰å…¨**: bcryptjs, ä¼šè¯ç®¡ç†

è¿™ä¸ªç³»ç»Ÿå±•ç¤ºäº†å¦‚ä½•åœ¨ Vercel å¹³å°ä¸Šæ„å»ºå®Œæ•´çš„ç”¨æˆ·ç®¡ç†ç³»ç»Ÿï¼ŒåŒ…æ‹¬æ•°æ®åº“æ“ä½œã€è®¤è¯æˆæƒã€ä¼šè¯ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚
